# ------------------------------------------------------------------------
# OWASP CRS Plugin
# Copyright (c) 2025 CRS project. All rights reserved.
#
# The OWASP CRS plugins are distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------

# OWASP CRS Plugin
# Plugin name: referer-hardening
# Plugin description: 
# Rule ID block base: 9,524,000 - 9,524,999
# Plugin version: 1.0.0

# Documentation can be found here:
# https://github.com/coreruleset/referer-hardening-plugin

# Directive SecRuleUpdateTargetById, unfortunately, doesn't support 'OFFSET'
# like SecRuleUpdateActionById, so affected rules are commented out - keeping it
# here just to see what is NOT handled by this plugin.
#SecRuleUpdateTargetById 920250:1 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 920500 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 921190 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 930130 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 931131 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933135 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933150 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933160 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933180 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933210 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933151 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933161 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 933211 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 934100 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 934110 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 934160 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 934170 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 934101 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 934120 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941110 "TX:referer-hardening-plugin_request_filename,TX:referer-hardening-plugin_request_uri_raw,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 941130 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941140 "TX:referer-hardening-plugin_request_filename,TX:referer-hardening-plugin_request_uri_raw,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 941160 "TX:referer-hardening-plugin_request_filename,TX:referer-hardening-plugin_request_uri_raw,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 941170 "TX:referer-hardening-plugin_request_filename,TX:referer-hardening-plugin_request_uri_raw,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 941180 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941190 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941200 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941210 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941220 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941230 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941240 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941250 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941260 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941270 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941280 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941290 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941300 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941310 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941350 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941360 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941370 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941390 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941400 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941101 "TX:referer-hardening-plugin_request_filename,TX:referer-hardening-plugin_request_uri_raw,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 941120 "TX:referer-hardening-plugin_request_filename,TX:referer-hardening-plugin_request_uri_raw,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 941150 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941181 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941320 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941330 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941340 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 941380 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 942160 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 942550 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 942120 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 942101 TX:referer-hardening-plugin_request_filename
SecRuleUpdateTargetById 944130 "TX:referer-hardening-plugin_request_filename,TX:referer-hardening-plugin_request_uri,!REQUEST_HEADERS:Referer"

SecRuleUpdateTargetById 931110 TX:referer-hardening-plugin_query_string

SecRuleUpdateTargetById 920260 TX:referer-hardening-plugin_request_uri_raw
# Directive SecRuleUpdateTargetById, unfortunately, doesn't support 'OFFSET'
# like SecRuleUpdateActionById, so affected rules are commented out - keeping it
# here just to see what is NOT handled by this plugin.
#SecRuleUpdateTargetById 920540:1 "TX:referer-hardening-plugin_request_uri,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 920460 "TX:referer-hardening-plugin_request_uri,!REQUEST_HEADERS:Referer"
SecRuleUpdateTargetById 920610 TX:referer-hardening-plugin_request_uri_raw

SecRuleUpdateTargetById 930100 TX:referer-hardening-plugin_request_uri_raw
SecRuleUpdateTargetById 930110 TX:referer-hardening-plugin_request_uri_raw
